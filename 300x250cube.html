<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Flip Creative</title>

  <style>
    *{margin:0;padding:0;box-sizing:border-box}body{display:flex;justify-content:center;align-items:center;min-height:100vh}.ad-container{width:300px;height:250px;position:relative;overflow:hidden;cursor:pointer}.ad-cube,.cube-face a,.cube-face img{width:100%;height:100%}.ad-cube{position:absolute;transform-style:preserve-3d;transition:transform 1s ease-in-out}.cube-face{position:absolute;width:300px;height:250px;backface-visibility:hidden;pointer-events:none}.cube-face a{display:block}.cube-face img{object-fit:contain;display:block}.face-1{transform:rotateY(0) translateZ(150px)}.face-2{transform:rotateY(90deg) translateZ(150px)}.face-3{transform:rotateY(180deg) translateZ(150px)}.face-4{transform:rotateY(270deg) translateZ(150px)}
  </style>
</head>

<body>

 <div class=ad-container id=adContainer><div class=ad-cube id=adCube><div class="cube-face face-1"data-creative=0><a data-impression="https://surgex.media-412.com/click?pid=2&offer_id=3733&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"href="https://surgex.media-412.com/click?pid=2&offer_id=3734&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"><img alt=rotationbms loading=lazy src=https://assets.mobavenue.com/static/truecaller/creative/rotationbms.gif></a></div><div class="cube-face face-2"data-creative=1><a data-impression="https://surgex.media-412.com/click?pid=2&offer_id=3731&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"href="https://surgex.media-412.com/click?pid=2&offer_id=3732&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"><img alt=CoinSwitch loading=lazy src=https://assets.mobavenue.com/static/truecaller/creative/rotationcoinswitch.gif></a></div><div class="cube-face face-3"data-creative=2><a data-impression="https://view.adjust.com/impression/1noi2csf?campaign=Mobavenue_DSP_Prog&adgroup=6206_25&creative=TCTESTDCX_25${TAG_ID}&click_id=${BIDID}&gps_adid=${IFA}&android_id=${IFA}&install_callback=https%3A%2F%2Fpostback.mobavenue.com%2Fadjust%2Finstall%3Fbidid%3D${BIDID}%26click_time%3D{click_time}%26engagement_time%3D{engagement_time}%26installed_at%3D{installed_at}%26is_organic%3D{is_organic}%26network_name%3D{network_name}%26received_at%3D{received_at}%26app_id%3D{app_id}%26sk_invalid_signature%3D{sk_invalid_signature}%26city%3D{city}%26country%3D{country}%26device_model%3D{device_model}%26device_name%3D{device_name}%26device_type%3D{device_type}%26gps_adid%3D{gps_adid}%26idfa%3D{idfa}%26ip_address%3D{ip_address}%26match_type%3D{match_type}%26partner%3D{partner}%26region%3D{region}%26os_name%3D{os_name}%26os_version%3D{os_version}"href="https://app.adjust.com/1noi2csf?campaign=Mobavenue_DSP_Prog&adgroup=6206_25&creative=TCTESTDCX_25${TAG_ID}&click_id=${BIDID}&gps_adid=${IFA}&android_id=${IFA}&install_callback=https%3A%2F%2Fpostback.mobavenue.com%2Fadjust%2Finstall%3Fbidid%3D${BIDID}%26click_time%3D{click_time}%26engagement_time%3D{engagement_time}%26installed_at%3D{installed_at}%26is_organic%3D{is_organic}%26network_name%3D{network_name}%26received_at%3D{received_at}%26app_id%3D{app_id}%26sk_invalid_signature%3D{sk_invalid_signature}%26city%3D{city}%26country%3D{country}%26device_model%3D{device_model}%26device_name%3D{device_name}%26device_type%3D{device_type}%26gps_adid%3D{gps_adid}%26idfa%3D{idfa}%26ip_address%3D{ip_address}%26match_type%3D{match_type}%26partner%3D{partner}%26region%3D{region}%26os_name%3D{os_name}%26os_version%3D{os_version}"><img alt=CoinDcx loading=lazy src=https://assets.mobavenue.com/static/truecaller/creative/rotationcoindcx.gif></a></div><div class="cube-face face-4"data-creative=3><a data-impression="https://surgex.media-412.com/click?pid=2&offer_id=3735&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"href="https://surgex.media-412.com/click?pid=2&offer_id=3736&escape=subs&sub3=${IFA}&sub5=${BUNDLE_ID}&sub6=${UA}&sub7=${IP}&sub1=${CREATIVE_ID}&sub2=${CAMPAIGN_ID}&sub4=${TAG_ID}&sub8=${BIDID}"><img alt=rotationbgmi loading=lazy src=https://assets.mobavenue.com/static/truecaller/creative/rotationbgmi.gif></a></div></div></div>

  <script>
    const firedImpressions = [];

    function fireImpression(index) {
      if (firedImpressions.includes(index)) return;
      const face = document.querySelector(`[data-creative="${index}"]`);
      if (!face) return;

      const url = face.querySelector("a").dataset.impression;
      if (url) {
        new Image().src = url;
        firedImpressions.push(index);
        console.log("Impression fired:", index);
      }
    }

    fireImpression(0);

    const adCube = document.getElementById("adCube");
    const adContainer = document.getElementById("adContainer");
    const faces = document.querySelectorAll(".cube-face");

    const ROTATION_INTERVAL = 1000;
    const totalFaces = 4;

    let rotationDegree = 0;
    let currentFace = 0;
    let rotationTimer = null;

    function updatePointerEvents(activeIndex) {
      faces.forEach((face, i) => {
        face.style.pointerEvents = i === activeIndex ? "auto" : "none";
      });
    }

    updatePointerEvents(0);

    function rotateCube() {
      stopRotation();

      rotationDegree -= 90;
      adCube.style.transform = `rotateY(${rotationDegree}deg)`;
      currentFace = (currentFace + 1) % totalFaces;

      adCube.addEventListener("transitionend", function handler() {
        updatePointerEvents(currentFace);
        fireImpression(currentFace);
        startRotation();
        adCube.removeEventListener("transitionend", handler);
      });
    }

    function startRotation() {
      if (rotationTimer) return;
      rotationTimer = setInterval(rotateCube, ROTATION_INTERVAL);
    }

    function stopRotation() {
      clearInterval(rotationTimer);
      rotationTimer = null;
    }

    startRotation();

    adContainer.addEventListener("mouseenter", stopRotation);
    adContainer.addEventListener("mouseleave", startRotation);

    document.addEventListener("click", function (e) {
      const link = e.target.closest("a[data-impression]");
      if (!link) return;

      e.preventDefault();
      stopRotation();

      const face = link.closest("[data-creative]");
      const index = parseInt(face.dataset.creative, 10);
      fireImpression(index);

      window.open(link.href, "_blank");
    });
  </script>

</body>

</html>